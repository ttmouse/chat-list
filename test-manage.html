<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†é¢æ¿æµ‹è¯•</title>
    <link rel="stylesheet" href="content.css">
</head>
<body>
    <div id="chat-list-widget">
        <div class="widget-wrapper">
            <div class="widget-header">
                <span class="widget-title">è¯æœ¯åŠ©æ‰‹ <span class="version">v1.1.0</span></span>
                <div class="widget-controls">
                    <button class="btn-manage" title="ç®¡ç†è¯æœ¯"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85643 16.1891C5.59976 15.8149 4.48117 15.1203 3.59545 14.1999C3.92587 13.8083 4.125 13.3023 4.125 12.7499C4.125 11.5072 3.11764 10.4999 1.875 10.4999C1.79983 10.4999 1.72552 10.5036 1.65225 10.5108C1.55242 10.0227 1.5 9.51743 1.5 8.99986C1.5 8.21588 1.62029 7.45999 1.84342 6.74963C1.85393 6.74978 1.86446 6.74986 1.875 6.74986C3.11764 6.74986 4.125 5.74249 4.125 4.49986C4.125 4.14312 4.04197 3.80581 3.89422 3.50611C4.76156 2.69963 5.82019 2.09608 6.99454 1.771C7.36665 2.50039 8.12501 2.99987 9 2.99987C9.87499 2.99987 10.6334 2.50039 11.0055 1.771C12.1798 2.09608 13.2384 2.69963 14.1058 3.50611C13.958 3.80581 13.875 4.14312 13.875 4.49986C13.875 5.74249 14.8824 6.74986 16.125 6.74986C16.1355 6.74986 16.1461 6.74978 16.1566 6.74963C16.3797 7.45999 16.5 8.21588 16.5 8.99986C16.5 9.51743 16.4476 10.0227 16.3478 10.5108C16.2745 10.5036 16.2002 10.4999 16.125 10.4999C14.8824 10.4999 13.875 11.5072 13.875 12.7499C13.875 13.3023 14.0741 13.8083 14.4045 14.1999C13.5188 15.1203 12.4002 15.8149 11.1436 16.1891C10.8535 15.2818 10.0035 14.6249 9 14.6249C7.9965 14.6249 7.14645 15.2818 6.85643 16.1891Z" stroke="#333333" stroke-width="0.75" stroke-linejoin="round"/><path d="M9 11.625C10.4497 11.625 11.625 10.4497 11.625 9C11.625 7.55025 10.4497 6.375 9 6.375C7.55025 6.375 6.375 7.55025 6.375 9C6.375 10.4497 7.55025 11.625 9 11.625Z" stroke="#333333" stroke-width="0.75" stroke-linejoin="round"/></svg></button>
                    <button class="btn-toggle" title="æ”¶èµ·/å±•å¼€">ğŸ“‹</button>
                    <button class="btn-close" title="å…³é—­"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 16.5C13.1421 16.5 16.5 13.1421 16.5 9C16.5 4.85786 13.1421 1.5 9 1.5C4.85786 1.5 1.5 4.85786 1.5 9C1.5 13.1421 4.85786 16.5 9 16.5Z" stroke="#333333" stroke-width="0.75" stroke-linejoin="round"/><path d="M11.1211 6.87891L6.87842 11.1215" stroke="#333333" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M6.87891 6.87891L11.1215 11.1215" stroke="#333333" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
                </div>
            </div>
            <div class="widget-content">
                <div class="script-list">
                    <div class="script-item">
                        <div class="script-content">
                            <div class="script-title">æµ‹è¯•è¯æœ¯</div>
                            <div class="script-text">è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•è¯æœ¯å†…å®¹</div>
                        </div>
                        <div class="script-actions">
                            <button class="btn-edit" data-id="1">ç¼–è¾‘</button>
                            <button class="btn-delete" data-id="1">åˆ é™¤</button>
                        </div>
                    </div>
                </div>
                <div class="widget-actions">
                    <button class="btn-add-script">+ æ·»åŠ è¯æœ¯</button>
                </div>
            </div>
            <div class="manage-panel" style="display: none;">
                <div class="manage-header">
                    <span>è¯æœ¯ç®¡ç†</span>
                    <button class="btn-close-manage"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 16.5C13.1421 16.5 16.5 13.1421 16.5 9C16.5 4.85786 13.1421 1.5 9 1.5C4.85786 1.5 1.5 4.85786 1.5 9C1.5 13.1421 4.85786 16.5 9 16.5Z" stroke="#333333" stroke-width="0.75" stroke-linejoin="round"/><path d="M11.1211 6.87891L6.87842 11.1215" stroke="#333333" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M6.87891 6.87891L11.1215 11.1215" stroke="#333333" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
                </div>
                <div class="manage-content">
                    <div class="group-management">
                        <h4>åˆ†ç»„ç®¡ç†</h4>
                        <div class="group-list"></div>
                        <button class="btn-add-group">+ æ·»åŠ åˆ†ç»„</button>
                    </div>
                    <div class="script-management">
                        <h4>è¯æœ¯ç¼–è¾‘</h4>
                        <div class="script-form">
                            <input type="hidden" id="edit-script-id">
                            <input type="text" id="script-title" placeholder="è¯æœ¯æ ‡é¢˜">
                            <select id="script-group">
                                <option value="">é€‰æ‹©åˆ†ç»„</option>
                            </select>
                            <textarea id="script-content" placeholder="è¯æœ¯å†…å®¹"></textarea>
                            <div class="form-actions">
                                <button class="btn-save-script">ä¿å­˜</button>
                                <button class="btn-cancel-edit">å–æ¶ˆ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æµ‹è¯•ç®¡ç†é¢æ¿æ˜¾ç¤º
        function showManagePanel() {
            const widget = document.getElementById('chat-list-widget');
            const managePanel = widget.querySelector('.manage-panel');
            const widgetContent = widget.querySelector('.widget-content');
            
            console.log('ç®¡ç†é¢æ¿å…ƒç´ :', managePanel);
            console.log('å†…å®¹åŒºåŸŸå…ƒç´ :', widgetContent);
            console.log('ç®¡ç†é¢æ¿å½“å‰æ ·å¼:', managePanel ? managePanel.style.display : 'null');
            
            if (managePanel && widgetContent) {
                managePanel.style.display = 'block';
                widgetContent.style.display = 'none';
                console.log('ç®¡ç†é¢æ¿å·²æ˜¾ç¤ºï¼Œæ–°æ ·å¼:', managePanel.style.display);
                
                // æ£€æŸ¥ç®¡ç†é¢æ¿æ˜¯å¦çœŸçš„å¯è§
                const rect = managePanel.getBoundingClientRect();
                console.log('ç®¡ç†é¢æ¿ä½ç½®å’Œå¤§å°:', rect);
            } else {
                console.error('æ‰¾ä¸åˆ°ç®¡ç†é¢æ¿æˆ–å†…å®¹åŒºåŸŸå…ƒç´ ');
            }
        }
        
        function hideManagePanel() {
            const widget = document.getElementById('chat-list-widget');
            const managePanel = widget.querySelector('.manage-panel');
            const widgetContent = widget.querySelector('.widget-content');
            
            if (managePanel && widgetContent) {
                managePanel.style.display = 'none';
                widgetContent.style.display = 'block';
                console.log('ç®¡ç†é¢æ¿å·²éšè—');
            }
        }
        
        // ç»‘å®šäº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆ');
            
            // ç®¡ç†æŒ‰é’®
            const manageBtn = document.querySelector('.btn-manage');
            if (manageBtn) {
                manageBtn.addEventListener('click', function() {
                    console.log('ç‚¹å‡»ç®¡ç†æŒ‰é’®');
                    showManagePanel();
                });
            }
            
            // å…³é—­ç®¡ç†é¢æ¿
            const closeBtn = document.querySelector('.btn-close-manage');
            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    console.log('ç‚¹å‡»å…³é—­æŒ‰é’®');
                    hideManagePanel();
                });
            }
            
            // ç¼–è¾‘æŒ‰é’®
            const editBtn = document.querySelector('.btn-edit');
            if (editBtn) {
                editBtn.addEventListener('click', function() {
                    console.log('ç‚¹å‡»ç¼–è¾‘æŒ‰é’®');
                    showManagePanel();
                    // å¡«å……æµ‹è¯•æ•°æ®
                    document.getElementById('script-title').value = 'æµ‹è¯•è¯æœ¯';
                    document.getElementById('script-content').value = 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•è¯æœ¯å†…å®¹';
                });
            }
            
            // æ·»åŠ è¯æœ¯æŒ‰é’®
            const addBtn = document.querySelector('.btn-add-script');
            if (addBtn) {
                addBtn.addEventListener('click', function() {
                    console.log('ç‚¹å‡»æ·»åŠ è¯æœ¯æŒ‰é’®');
                    showManagePanel();
                    // æ¸…ç©ºè¡¨å•
                    document.getElementById('script-title').value = '';
                    document.getElementById('script-content').value = '';
                });
            }
        });
    </script>
</body>
</html>